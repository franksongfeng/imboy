
# 消息结构体
```
Msg = {"id":ID, "status":Status, "type":Type, "from":From, "to":To, "payload": Payload, "server_ts": ServerTs}
```

# Msg.id
Xid().toString()


# Msg.Type
## 单聊（c2c[any()]）
* Msg.Type = <<"c2c">>

## 群聊(c2g[any()])

## 推送(S2C)
* Payload.msg_type = 706 需要重新登录, Payload.content = ""
* Payload.msg_type = 786 在其他设备登录了, Payload.content = ""
* Payload.msg_type = 1019 用户在线状态变更, Payload.content = ""
* Payload.msg_type = apply_as_a_friend 添加好友申请, Payload.content = ""

apply_as_a_friend
```
{"from":{"source":"qrcode","msg":"我是 nick leeyi👍🏻👍🏻就","remark":"leeyi101","role":"all","donotlookhim":false,"donotlethimlook":true},"to":{},"msg_type":"custom","custom_type":"apply_as_a_friend"}
```

## 客户端确认消息 CLIENT_ACK
```
% 客户端确认消息
websocket_handle({text, <<"CLIENT_ACK", Tail/binary>>}, State) ->
    [Type, MsgId, DID] = binary:split(Tail, <<",">>, [global]),
    ?LOG(["CLIENT_ACK", Tail]),
    CurrentUid = proplists:get_value(current_uid, State),
    case Type of
        <<"C2C">> ->
            websocket_logic:c2c_client_ack(MsgId, CurrentUid, DID),
            {ok, State, hibernate};
        <<"S2C">> ->
            websocket_logic:s2c_client_ack(MsgId, CurrentUid, DID),
            {ok, State, hibernate}
    end;
```

# ServerTs
服务器的当前毫秒时间戳
```
 Ts = util_dt:milliseconds(),
```
